# Log设计

## 功能需求

1. 日志消息可以有多个目的地，除了能打印到控制台， 还可以输出到文件等
2. 日志内容应该可以做格式化， 例如变成纯文本，XML, HTML格式等等
3. 可以设置运行时过滤器，对于不同的组件，应该可以设置不同的日志级别和文件
4. 能对日志进行分级， 应该有trace、debug、info、warn、error、fatal等级别
5. 应该能在所有情况下都能记录日志



## 需要考虑的问题

1. 是否应该有多线程写入？如果有多线程写入如何保证写入顺序？

2. 如何设计缓冲区保证写入速度？

3. 日志中需要反复读取时间，如何进行优化？

   

## 回答

1、没有多线程写入，多线程写入可能并不能提速，有可能受限于硬盘写入速度，并且会带来并行问题，单个进程就只有一个写入线程

2、使用双缓冲区保证写入速度，使用区分前后端两个缓存，前端缓存负责从其他线程收集log，后端缓存负责提供给写入线程进行写入，把快的线程和慢的线程使用的缓存进行分离，避免因为写入过慢阻塞

3、？？？

